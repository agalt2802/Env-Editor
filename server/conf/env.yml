DELETEDIR:
  NAME: DELETEDIR
  STEPS:
    - RUN: deleteFolders
      STEP_CONTROL: verifyDeleteFolders
      STEP_DAYS_BEFORE: '25'
SENDREPORT:
  NAME: SENDREPORT
  STEPS:
    - RUN: sendReport
      STEP_CONTROL: verifySendReport
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: tmp@DAILY_INFOFILE@
      STEP_SOURCEDIR: '@FLOWSPATH@'
      STEP_SOURCEFILE: '@DAILY_INFOFILE@'
      STEP_MAIL_TO: 'o1.rouhaim@reply.it, a1.altomare@reply.it'
      STEP_MAIL_SUBJECT: STARTED FLOW @FLOWNAME@
      MAILTEXT: |
        A seguire il report dei flussi eseguiti in data odierna: 
TEST_SFTP_KUBE:
  NAME: TEST_SFTP_KUBE
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      STEP_SFTP_SOURCE_PATH: <STEP_SFTP_SOURCE_PATH>
      STEP_SFTP_SOURCE_FILE: LOCALINIT%yyMMdd%.csv
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ONSERVER%yyyyMMdd%.csv
      STEP_DESCRIPTION: create a csv from txt file
      SFTP_DELETESOURCE: true
      SFTP_USERNAME: SECRETS.SFTPSERVICE.SFTP_USERNAME
      SFTP_PASSWORD: SECRETS.SFTPSERVICE.SFTP_PASSWORD
      RETRY: 5
      SLEEP: 5
    - RUN: touchFile
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: touchfile.txt.OK
      STEP_DESCRIPTION: 'create thumb file, at the end will be copied to SENT extension'
    - RUN: toRemoteSftpPut
      STEP_CONTROL: controlFileIsThere
      STEP_CONTROLFILE: touchfile.txt.SENT
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: ONSERVER%yyyyMMdd%.csv
      STEP_SFTP_DEST_PATH: <STEP_SFTP_DEST_PATH>
      STEP_SFTP_DEST_FILE: LOCALINIT%yyMMdd%.csv
      STEP_SOURCETHUMB: touchfile.txt.OK
      STEP_SFTP_DEST_THUMB: touchfile1.txt.OK
      SFTP_USERNAME: SECRETS.SFTPSERVICE.SFTP_USERNAME
      SFTP_PASSWORD: SECRETS.SFTPSERVICE.SFTP_PASSWORD
      RETRY: 3
      SLEEP: 5
CSV_MANAGEMENT:
  NAME: CSV_MANAGEMENT
  STEPS:
    - RUN: unZipFolderFiles
      STEP_SOURCEDIR: /src/usr/app/output
      STEP_CONTROL: unZipIsDone
      STEP_CONTROLFILE: csv.zip.UNZIPPED
      STEP_SOURCEFILE: csv.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: csv.zip
      RETRY: 3
      SLEEP: 5
    - RUN: makeQueryOnCSV2
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: AYTM.TO.MATERI.Z9.P221121.txt
      STEP_QUERY: SELECT a.* WHERE a.Nmu_c1 == 1234
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: output1.csv
      RETRY: 3
      SLEEP: 5
    - RUN: zipFolderFiles
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: /.csv$
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Catalog_Brand%yyyyMMdd%.zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DB_FLOW:
  NAME: DB_FLOW
  STEPS:
    - RUN: sendMail
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_MAIL_TO: 'o1.rouhaim@reply.it, a1.altomare@reply.it'
      STEP_MAIL_SUBJECT: STARTED FLOW @FLOWNAME@
      MAILTEXT: The flow @FLOWNAME@ already started
    - RUN: importTableFromCsv
      STEP_CONTROL: destinationFileIsThere
      STEP_TBLNAME: persons
      STEP_TRUNCATETBL: true
      STEP_CSVDELIMITER: ;
      STEP_SOURCEDIR: /src/usr/app/output
      STEP_SOURCEFILE: importTableFromCsv.csv
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: importTableFromCsv.csv.OK
    - RUN: executeQueryOnTable
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: executeQueryOnTable.csv
      STEP_QUERY: >-
        Select P.*, SUM(eta) over (PARTITION BY genere ORDER BY id) AS somma
        from persons AS p
    - RUN: extractTableOnCsv
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: extractTableOnCsv.csv
      STEP_TBLNAME: persons
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DB_FLOW2:
  NAME: DB_FLOW2
  STEPS:
    - RUN: sendMail
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_MAIL_TO: 'o1.rouhaim@reply.it, a1.altomare@reply.it'
      STEP_MAIL_SUBJECT: STARTED FLOW @FLOWNAME@
      MAILTEXT: The flow @FLOWNAME@ already started
    - RUN: importTableFromCsv
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_TBLNAME: persons
      STEP_CSVDELIMITER: ;
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: importTableFromCsv.csv
    - RUN: executeQueryOnTable
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: executeQueryOnTable.csv
      STEP_QUERY: >-
        Select P.*, SUM(eta) over (PARTITION BY genere ORDER BY id) AS somma
        from persons AS p
    - RUN: extractTableOnCsv
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: extractTableOnCsv.csv
      STEP_TBLNAME: persons
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
FIRSTRUN:
  NAME: FIRSTRUN
  STEPS:
    - RUN: unZipFolderFiles
      STEP_CONTROL: unZipIsDone
      STEP_CONTROLFILE: csv.zip.UNZIPPED
      STEP_SOURCEDIR: '@FLOWSPATH@'
      STEP_SOURCEFILE: csv.zip
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: csv.zip
      RETRY: 3
      SLEEP: 5
    - RUN: makeQueryOnCSV2
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWSPATH@'
      STEP_SOURCEFILE: AYTM.TO.MATERI.Z9.P221121.txt
      STEP_QUERY: SELECT * WHERE a.Nmu_c1 == 1234
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: output1.csv
      RETRY: 3
      SLEEP: 5
    - RUN: makeQueryOnCSV2
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWSPATH@'
      STEP_SOURCEFILE: AYTM.TO.MATERI.Z9.P221121.txt
      STEP_JOINFILE: 1AYTM.TO.MATERI.Z9.P221121.txt
      STEP_QUERY: >-
        SELECT * JOIN @STEP_JOINFILE@ ON a.Nmu_c1 == b.Nmu_c AND a.Data_c1 ==
        b.Data_c
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: output.csv
      RETRY: 3
      SLEEP: 5
    - RUN: makeQueryOnCSV2
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWSPATH@'
      STEP_SOURCEFILE: TIMKPIONHM_mn_v2.csv
      STEP_JOINFILE: output.csv
      STEP_QUERY: >-
        SELECT * JOIN @STEP_JOINFILE@ ON a.Nmu_c2 == b.Nmu_c1 AND a.Data_c2 ==
        b.Data_c1
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: output.csv
      RETRY: 3
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SECONDRUN:
  NAME: SECONDRUN
  STEPS:
    - RUN: sendMail
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_MAIL_TO: 'o1.rouhaim@reply.it, a1.altomare@reply.it'
      STEP_MAIL_SUBJECT: STARTED FLOW @FLOWNAME@
      MAILTEXT: The flow @FLOWNAME@ already started
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: '%dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE '
UPLOADCTONHM:
  NAME: UPLOADCTONHM
  STEPS:
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: /src/usr/app/output
      STEP_SOURCEFILE: TIMKPIONHM_mn_v2.txt
      STEP_OPERATION_NAME: uploadFileToUCM
      STEP_DOCUMENT_ACCOUNT: scm$/planningDataLoader$/import$
      STEP_FILE_EXTENTION: txt
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      RETRY: 5
      SLEEP: 5
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEFILE: ctUploadResult%yyyyMMdd%.json
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresult.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile
      STEP_JOB_DEF_NAME: TIM_GET_DOCUMENT_NAME
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresult.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 5
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essgetstatusresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontent.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerImportActivities
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontent.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ImportActivities.json
      STEP_REQUEST_NAME: TIMKPIONHM_a
      STEP_REQUEST_DESC: TIMKPIONHM_a
      STEP_OBJECT_CODE: TIMMobileKPIOnHandNew_c
      RETRY: 2
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
UPLOADCTNMU:
  NAME: UPLOADCTNMU
  STEPS:
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: ''
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: TIMKPIITMM_a.csv
      STEP_OPERATION_NAME: uploadFileToUCM
      STEP_DOCUMENT_ACCOUNT: scm$/planningDataLoader$/import$
      STEP_FILE_EXTENTION: txt
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      RETRY: 5
      SLEEP: 5
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEFILE: ctUploadResult%yyyyMMdd%.json
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresult.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile
      STEP_JOB_DEF_NAME: TIM_GET_DOCUMENT_NAME
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresult.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 5
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essgetstatusresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontent.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerImportActivities
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontent.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ImportActivities.json
      STEP_REQUEST_NAME: TIMKPIITMM_a
      STEP_REQUEST_DESC: TIMKPIITMM_a
      STEP_OBJECT_CODE: TIMMobileKPINMUNew_c
      RETRY: 2
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DOWNLOADCT:
  NAME: DOWNLOADCT
  STEPS:
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresult.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile
      STEP_JOB_DEF_NAME: TIM_MOBILE_SUGG_PIANO
      STEP_ESS_PARAMETERS: '#NULL'
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresult.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 5
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essgetstatusresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontent.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 2
      SLEEP: 5
    - RUN: cleanZip
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontent.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: destinazione.zip
      STEP_DESCRIPTION: 'create empty file, at the end will be copied to SENT extension'
      RETRY: 5
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: '%dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE '
IAMCREATEREQUEST:
  NAME: IAMCREATEREQUEST
  STEPS:
    - RUN: removeRequestResponseDir
      STEP_CONTROL: verifyRemoveRequestResponseDir
      STEP_DESTINATIONDIR: '@FLOWSPATH@/request, @FLOWSPATH@/response'
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerGetAllUsers
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_LOGDIR: '@FLOWPATH@'
      STEP_DESTINATIONDIR: '@FLOWSPATH@/response'
      STEP_DESTINATIONFILE: getAllUsersResponse.json
    - RUN: generateRequestCreateEmployees
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR_RESPONSE: '@FLOWSPATH@/response'
      STEP_SOURCEFILE_IAM: /retrieveUsersResponse.json
      STEP_SOURCEFILE_GETALLUSERS: /getAllUsersResponse.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/request'
      STEP_DESTINATIONFILE: createEmployeesRequest.json
    - RUN: generateRequestUpdateUsers
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWSPATH@/response'
      STEP_SOURCEFILE_IAM: /retrieveUsersResponse.json
      STEP_SOURCEFILE_GETALLUSERS: /getAllUsersResponse.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/request'
      STEP_DESTINATIONFILE: updateUsersRequest.json
    - RUN: generateRequestDeleteUsers
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWSPATH@/response'
      STEP_SOURCEFILE_IAM: /retrieveUsersResponse.json
      STEP_SOURCEFILE_GETALLUSERS: /getAllUsersResponse.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/request'
      STEP_DESTINATIONFILE: deleteUsersRequest.json
    - RUN: writeInfoToFile
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: '%dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE '
ORACLE_CRUDUSER:
  NAME: ORACLE_CRUDUSER
  STEPS:
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUpdateUsers
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_LOGDIR: '@FLOWPATH@'
      STEP_SOURCEDIR: '@FLOWSPATH@/request'
      STEP_SOURCEFILE: updateUsersRequest.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/response'
      STEP_DESTINATIONFILE: updateUsersResponse.json
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerDeleteUsers
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_LOGDIR: '@FLOWPATH@'
      STEP_SOURCEDIR: '@FLOWSPATH@/request'
      STEP_SOURCEFILE: deleteUsersRequest.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/response'
      STEP_DESTINATIONFILE: deleteUsersResponse.json
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerCreateEmployees
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_LOGDIR: '@FLOWPATH@'
      STEP_SOURCEDIR: '@FLOWSPATH@/request'
      STEP_SOURCEFILE: createEmployeesRequest.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/response'
      STEP_DESTINATIONFILE: createEmployeesResponse.json
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetNewUsers
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_LOGDIR: '@FLOWPATH@'
      STEP_SOURCEDIR: '@FLOWSPATH@/response'
      STEP_SOURCEFILE: createEmployeesResponse.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/response'
      STEP_DESTINATIONFILE: getNewUsersResponse.json
      RETRY: 2
      SLEEP: 5
    - RUN: generateRequestUpdateRoles
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR_RESPONSE: '@FLOWSPATH@/response'
      STEP_SOURCEDIR_ROLELIST: '@ROOTPATH@'
      STEP_SOURCEFILE_IAM: /retrieveUsersResponse.json
      STEP_SOURCEFILE_GETALLUSERS: /getAllUsersResponse.json
      STEP_SOURCEFILE_CREATEUSERS: /getNewUsersResponse.json
      STEP_SOURCEFILE_ROLELIST: /rolesList.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/request'
      STEP_DESTINATIONFILE: updateRolesRequest.json
    - RUN: controlTowerUpdateRole
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_LOGDIR: '@FLOWPATH@'
      STEP_SOURCEDIR: '@FLOWSPATH@/request'
      STEP_SOURCEFILE: updateRolesRequest.json
      STEP_DESTINATIONDIR: '@FLOWSPATH@/response'
      STEP_DESTINATIONFILE: updateRolesResponse.json
      RETRY: 2
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: '%dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE '
DOWNLOAD_UPLOAD_LOGINDATA:
  NAME: DOWNLOAD_UPLOAD_LOGINDATA
  STEPS:
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresultDownload.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: oracle/apps/ess/custom/TIM_LOGIN
      STEP_JOB_DEF_NAME: TIM_LOGIN_ARCHIVE
      STEP_ESS_PARAMETERS: 'null'
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresultDownload.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresultDownload.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 5
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essgetstatusresultDownload.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontentDownload.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 2
      SLEEP: 5
    - RUN: unZipFolderFiles
      STEP_CONTROL: unZipIsDone
      STEP_CONTROLFILE: essjobexecutioncontentDownload.zip.UNZIPPED
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontentDownload.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontentDownload.zip
      RETRY: 3
      SLEEP: 5
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_OPERATION_NAME: uploadFileToUCM
      STEP_DOCUMENT_ACCOUNT: scm$/planningDataLoader$/import$
      STEP_FILE_EXTENTION: txt
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%Upload.json
      RETRY: 5
      SLEEP: 5
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEFILE: ctUploadResult%yyyyMMdd%Upload.json
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresultUpload.json
      STEP_ENDPOINT: /fscmRestApi/resources/latest/erpintegrations
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile/
      STEP_JOB_DEF_NAME: TIM_GET_DOCUMENT_NAME
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatusLoginData
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresultUpload.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresultUpload.json
      STEP_OPERATION_NAME: ESSJobStatusRF
      RETRY: 5
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecutionLoginData
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essgetstatusresultUpload.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontentUpload.zip
      STEP_OPERATION_NAME: ESSJobExecutionDetailsRF
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerImportActivities
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontentUpload.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ImportActivitiesUpload.json
      STEP_REQUEST_NAME: TIMLoginArchive_%yyyyMMdd%
      STEP_REQUEST_DESC: TIMLoginArchive_%yyyyMMdd%
      STEP_OBJECT_CODE: TIMLoginArchive_c
      STEP_IMPORTMAPPING_PROD: '300000007903003'
      STEP_IMPORTMAPPING_DEV: '300000005768057'
      RETRY: 2
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
JWTGEN:
  NAME: JWTGEN
  STEPS:
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
TESTMAIL:
  NAME: TESTMAIL
  STEPS:
    - RUN: sendMail
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_MAIL_TO: SO000501@telecomitalia.it
      STEP_MAIL_SUBJECT: Avvio Flussi caricamento Control Tower
      MAILTEXT: Caricamento Automatico flussi Control tower avviato!
SENDSTART:
  NAME: SENDSTART
  STEPS:
    - RUN: sendMail
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_MAIL_TO: 'SO000501@telecomitalia.it,fabio.bianchini@telecomitalia.it'
      STEP_MAIL_SUBJECT: Avvio Flussi caricamento Control Tower
      MAILTEXT: Caricamento Automatico flussi Control tower avviato!
SAP2CT_00:
  NAME: SAP2CT_00
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Items_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Items_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: deleteFile
      STEP_CONTROL: destinationFileIsMissing
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Items_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DBU2CT_03:
  NAME: DBU2CT_03
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Catalogs_Brand_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Catalogs_Brand_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Catalogs_Brand_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DBU2CT_04:
  NAME: DBU2CT_04
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Catalogs_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Catalogs_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Catalogs_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DBU2CT_05:
  NAME: DBU2CT_05
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: BillofMaterials_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: BillofMaterials_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: BillofMaterials_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_20:
  NAME: SAP2CT_20
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Measures_SELLIN_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Measures_SELLIN_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Measures_SELLIN_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DBU2CT_01:
  NAME: DBU2CT_01
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Measures_ATTTIM_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Measures_ATTTIM_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Measures_ATTTIM_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
DBU2CT_02:
  NAME: DBU2CT_02
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Measures_ATTOLO_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Measures_ATTOLO_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Measures_ATTOLO_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_06_06b:
  NAME: SAP2CT_06_06b
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: PurchaseOrderRequisition_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: PurchaseOrderRequisition_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: PurchaseOrderRequisition_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_14:
  NAME: SAP2CT_14
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: SupplyOnhand_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: SupplyOnhand_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: SupplyOnhand_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_14b:
  NAME: SAP2CT_14b
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: Measures_ONHIMP_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: Measures_ONHIMP_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: Measures_ONHIMP_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_22:
  NAME: SAP2CT_22
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: SalesOrder_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: SalesOrder_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: SalesOrder_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_22b:
  NAME: SAP2CT_22b
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: SalesOrder_Shipped_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: SalesOrder_Shipped_%yyyyMMdd%.zip
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 3
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: SalesOrder_Shipped_%yyyyMMdd%.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: importBulkData
      STEP_DOCUMENT_ACCOUNT: ''
      STEP_FILE_EXTENTION: zip
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_00_KPI:
  NAME: SAP2CT_00_KPI
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.DBU_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.DBU_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.DBU_PASSPHRASE
      SFTP_HOST: 10.25.140.132
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SFTP_SOURCE_PATH: /cygdrive/r/CT/
      STEP_SFTP_SOURCE_FILE: TIMKPIITMM_%yyyyMMdd%.csv
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: TIMKPIITMM_%yyyyMMdd%.csv
      SFTP_DELETESOURCE: true
      RETRY: 3
      SLEEP: 30
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: TIMKPIITMM_%yyyyMMdd%.csv
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: uploadFileToUCM
      STEP_DOCUMENT_ACCOUNT: scm$/planningDataLoader$/import$
      STEP_FILE_EXTENTION: txt
      RETRY: 3
      SLEEP: 30
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEFILE: ctUploadResult%yyyyMMdd%.json
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresult.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile
      STEP_JOB_DEF_NAME: TIM_GET_DOCUMENT_NAME
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresult.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 3
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontent.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerImportActivities
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontent.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ImportActivities.json
      STEP_REQUEST_NAME: TIMKPIITMM_%yyyyMMdd%
      STEP_REQUEST_DESC: TIMKPIITMM_%yyyyMMdd%
      STEP_OBJECT_CODE: TIMMobileKPINMUNew_c
      RETRY: 2
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
SAP2CT_14_KPI:
  NAME: SAP2CT_14_KPI
  STEPS:
    - RUN: fromRemoteSftpGet
      STEP_CONTROL: destinationFileIsThere
      SFTP_USERNAME: SECRETS.SFTPSERVICE.SFTP_USERNAME
      SFTP_PASSWORD: SECRETS.SFTPSERVICE.SFTP_PASSWORD
      STEP_SFTP_SOURCE_PATH: 'C:/Users/ouali/Desktop/conf/simulatedSFTP/'
      STEP_SFTP_SOURCE_FILE: TIMKPIONHM_%yyyyMMdd%.csv
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: TIMKPIONHM_%yyyyMMdd%.csv
      SFTP_DELETESOURCE: false
      RETRY: 3
      SLEEP: 30
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/ct_cert_private.key
        PUBFILE: ./keys/ct_cert_public
        SHA1FP: SECRETS.CT_SHA1FPDEV
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerUploadContent
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: TIMKPIONHM_%yyyyMMdd%.csv
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ctUploadResult%yyyyMMdd%.json
      STEP_OPERATION_NAME: uploadFileToUCM
      STEP_DOCUMENT_ACCOUNT: scm$/planningDataLoader$/import$
      STEP_FILE_EXTENTION: txt
      RETRY: 3
      SLEEP: 30
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEFILE: ctUploadResult%yyyyMMdd%.json
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresult.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile
      STEP_JOB_DEF_NAME: TIM_GET_DOCUMENT_NAME
      ESS_PARAMETERS: '#NULL'
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresult.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 3
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontent.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 2
      SLEEP: 5
    - RUN: controlTowerImportActivities
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontent.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: ImportActivities.json
      STEP_REQUEST_NAME: TIMKPIONHM_%yyyyMMdd%
      STEP_REQUEST_DESC: TIMKPIONHM_%yyyyMMdd%
      STEP_OBJECT_CODE: TIMMobileKPIOnHandNew_c
      RETRY: 2
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
CT2SAP_01:
  NAME: CT2SAP_01
  STEPS:
    - RUN: deleteFile
      STEP_CONTROL: destinationFileIsMissing
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
    - RUN: jwtGeneration
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: jtwtoken.txt
      STEP_JWTGEN:
        PKFILE: ./keys/tim-ct-private-key-prod.pem
        PUBFILE: ./keys/tim-ct-public-key-prod.pem
        SHA1FP: SECRETS.CT_SHA1FP
        payload:
          prn: ENV_@ENV@_USER
        signOptions:
          issuer: Telecomitalia
          subject: ENV_@ENV@_USER
          expiresIn: 24h
          algorithm: RS256
          header:
            x5t: '%X5T%'
    - RUN: controlTowerRunEssJob
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_SOURCEFILE: ''
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobresult.json
      STEP_OPERATION_NAME: submitESSJobRequest
      STEP_JOB_PACKAGE_NAME: /oracle/apps/ess/custom/tim_mobile
      STEP_JOB_DEF_NAME: TIM_MOBILE_SUGG_PIANO
      STEP_ESS_PARAMETERS: '#NULL'
      RETRY: 3
      SLEEP: 30
    - RUN: controlTowerGetEssStatus
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essgetstatusresult.json
      STEP_OPERATION_NAME: getESSJobStatus
      RETRY: 5
      SLEEP: 30
    - RUN: controlTowerDownloadEssJobExecution
      STEP_CONTROL: destinationFileIsThere
      STEP_AUTH:
        TYPE: JWT
        JWT: CT_AUTH_JWT
        JWT_DIR: '@FLOWPATH@'
        JWT_FILE: jtwtoken.txt
      STEP_HTTP_PROXY: 'http://grfpra002rm001.griffon.local:8080'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobresult.json
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: essjobexecutioncontent.zip
      STEP_OPERATION_NAME: downloadESSJobExecutionDetails
      RETRY: 3
      SLEEP: 30
    - RUN: cleanZip
      STEP_CONTROL: destinationFileIsThere
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: essjobexecutioncontent.zip
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: CT2SAP%yyMMdd%.zip
      STEP_DESCRIPTION: 'create empty file, at the end will be copied to SENT extension'
      RETRY: 5
      SLEEP: 5
    - RUN: touchFile
      STEP_CONTROL: destinationFileIsThere
      STEP_DESTINATIONDIR: '@FLOWPATH@'
      STEP_DESTINATIONFILE: CT2SAP%yyMMdd%.OK
      STEP_DESCRIPTION: 'create thumb file, at the end will be copied to SENT extension'
    - RUN: toRemoteSftpPut
      STEP_CONTROL: controlFileIsThere
      STEP_CONTROLFILE: CT2SAP%yyMMdd%.SENT
      SFTP_USERNAME: SECRETS.SFTPSERVICE.SAP_USERNAME
      SFTP_KEY: SECRETS.SFTPSERVICE.SAP_KEY
      SFTP_PASSPHRASE: SECRETS.SFTPSERVICE.SAP_PASSPHRASE
      SFTP_HOST: 10.201.8.44
      SFTP_PORT: '22'
      SFTP_TIMEOUT: '30'
      STEP_SOURCEDIR: '@FLOWPATH@'
      STEP_SOURCEFILE: CT2SAP%yyMMdd%.zip
      STEP_SFTP_DEST_PATH: /SE3/in/
      STEP_SFTP_DEST_FILE: CT2SAP%yyMMdd%.zip
      STEP_SOURCETHUMB: CT2SAP%yyMMdd%.OK
      STEP_SFTP_DEST_THUMB: CT2SAP%yyMMdd%.OK
      RETRY: 3
      SLEEP: 5
    - RUN: writeInfoToFile
      STEP_CONTROL: verifyStep
      STEP_CONTROL_FLAG: false
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: '@DAILY_INFOFILE@'
      STEP_INFOTEXT: |
        %dd-MM-yyyy hh:mm:ss% @FLOWNAME@ ESEGUITO CORRETTAMENTE 
LASTFLOW:
  NAME: LASTFLOW
  STEPS:
    - RUN: sendReport
      STEP_CONTROL: verifySendReport
      STEP_DESTINATIONDIR: '@FLOWSPATH@'
      STEP_DESTINATIONFILE: tmp@DAILY_INFOFILE@
      STEP_SOURCEDIR: '@FLOWSPATH@'
      STEP_SOURCEFILE: '@DAILY_INFOFILE@'
      STEP_MAIL_TO: 'o1.rouhaim@reply.it, a1.altomare@reply.it'
      STEP_MAIL_SUBJECT: STARTED FLOW @FLOWNAME@
      MAILTEXT: |
        A seguire il report dei flussi eseguiti in data odierna: 
